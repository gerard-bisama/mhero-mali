(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["fhir-questionnaire"],{"0bc6":function(e,t,a){},4983:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ihris-section",attrs:{id:"section-"+e.id}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[a("v-card-title",{staticClass:"primary darken-1 white--text text-uppercase font-weight-bold"},[e._v(e._s(e.label))]),e._l(e.errors,(function(t,r){return a("v-card-text",{key:r,staticClass:"error white--text font-weight-bold"},[e._v(e._s(t))])})),a("v-card-text",{staticClass:"my-3"},[e._t("default")],2)],2)],1)},s=[],i={name:"ihris-questionnaire-section",props:["id","label","description","path","constraints"],data:function(){return{isQuestionnaireGroup:!0,errors:[]}}},n=i,c=a("2877"),o=a("6544"),l=a.n(o),d=a("b0af"),u=a("99d9"),v=Object(c["a"])(n,r,s,!1,null,null,null);t["default"]=v.exports;l()(v,{VCard:d["a"],VCardText:u["c"],VCardTitle:u["d"]})},5105:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"d-none"},[a("v-text-field",{attrs:{readonly:"","hide-details":"",dense:"",disabled:""},model:{value:e.hiddenValue,callback:function(t){e.hiddenValue=t},expression:"hiddenValue"}})],1)},s=[],i={name:"ihris-hidden",props:["label","path","hiddenType","hiddenValue"],data:function(){return{qField:"value"+this.hiddenType,value:this.hiddenValue}}},n=i,c=a("2877"),o=a("6544"),l=a.n(o),d=a("8654"),u=Object(c["a"])(n,r,s,!1,null,null,null);t["default"]=u.exports;l()(u,{VTextField:d["a"]})},e0c7:function(e,t,a){"use strict";var r=a("5530"),s=(a("0bc6"),a("7560")),i=a("58df");t["a"]=Object(i["a"])(s["a"]).extend({name:"v-subheader",props:{inset:Boolean},render:function(e){return e("div",{staticClass:"v-subheader",class:Object(r["a"])({"v-subheader--inset":this.inset},this.themeClasses),attrs:this.$attrs,on:this.$listeners},this.$slots.default)}})},f43a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[a("v-card-title",{staticClass:"primary white--text text-uppercase font-weight-bold"},[e._v(e._s(e.label))]),e._l(e.errors,(function(t,r){return a("v-card-text",{key:r,staticClass:"error white--text font-weight-bold"},[e._v(e._s(t))])})),a("v-card-text",{staticClass:"my-3"},[e._t("default")],2)],2)},s=[],i={name:"ihris-questionnaire-group",props:["label","path","constraints"],data:function(){return{isQuestionnaireGroup:!0,errors:[]}}},n=i,c=a("2877"),o=a("6544"),l=a.n(o),d=a("b0af"),u=a("99d9"),v=Object(c["a"])(n,r,s,!1,null,null,null);t["default"]=v.exports;l()(v,{VCard:d["a"],VCardText:u["c"],VCardTitle:u["d"]})},f977:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"my-3"},[a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e._t("default"),a("v-overlay",{attrs:{value:e.overlay}},[a("v-progress-circular",{attrs:{size:"50",color:"primary",indeterminate:""}}),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.overlay=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("v-navigation-drawer",{staticClass:"primary darken-1 white--text",staticStyle:{"z-index":"3"},attrs:{app:"",right:"",permanent:"",clipped:""}},[a("v-list",{staticClass:"white--text"},[a("v-list-item",[e.isEdit?a("v-btn",{staticClass:"accent darken-1",attrs:{dark:""},on:{click:function(t){return e.$router.go(-1)}}},[a("v-icon",{attrs:{light:""}},[e._v("mdi-content-save")]),a("span",[e._v("Back")])],1):e._e(),a("v-spacer"),e.valid?a("v-btn",{staticClass:"success darken-1",attrs:{dark:"",disabled:!e.valid},on:{click:function(t){return e.processFHIR()}}},[a("v-icon",{attrs:{light:""}},[e._v("mdi-content-save")]),a("span",[e._v("Save")])],1):a("v-btn",{staticClass:"warning",attrs:{dark:""},on:{click:function(t){return e.$refs.form.validate()}}},[a("v-icon",{attrs:{light:""}},[e._v("mdi-content-save")]),a("span",[e._v("Save")])],1)],1),a("v-divider",{attrs:{color:"white"}}),e.sectionMenu?a("v-subheader",{staticClass:"white--text"},[a("h2",[e._v("Sections")])]):e._e(),e._l(e.sectionMenu,(function(t){return a("v-list-item",{key:t.id,attrs:{href:"#section-"+t.id}},[a("v-list-item-content",{staticClass:"white--text"},[a("v-list-item-title",{staticClass:"text-uppercase"},[a("h4",[e._v(e._s(t.title))])]),a("v-list-item-subtitle",{staticClass:"white--text"},[e._v(e._s(t.desc))])],1)],1)}))],2)],1)],2)],1)},s=[],i=(a("7db0"),a("d3b7"),a("ac1f"),a("1276"),a("b85c")),n=(a("96cf"),a("1da1")),c=a("b383"),o={name:"ihris-questionnaire",props:["id","url","title","description","purpose","section-menu","view-page","edit","constraints"],data:function(){return{fhir:{},loading:!1,overlay:!1,isEdit:!1,valid:!0,advancedValid:!0}},created:function(){},methods:{processFHIR:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$refs.form.validate(),this.valid){e.next=3;break}return e.abrupt("return");case 3:return this.advancedValid=!0,this.overlay=!0,this.loading=!0,t=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r,s,n){var c,o,l,d,u,v,h,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n||(n={}),c=Object(i["a"])(s),e.prev=2,c.s();case 4:if((o=c.n()).done){e.next=67;break}if(l=o.value,d=r,u={},!l.isArray){e.next=11;break}e.next=39;break;case 11:if(!l.isQuestionnaireGroup){e.next=17;break}v={linkId:l.path,text:l.label,item:[]},d.push(v),d=v.item,e.next=39;break;case 17:if(!l.qField){e.next=39;break}if(h=void 0,n.hasOwnProperty(l.path)?h=n[l.path]:(h={linkId:l.path,answer:[]},n[l.path]=h,d.push(h)),p={},p[l.qField]=l.value,h.answer.push(p),!l.constraints){e.next=39;break}if(l.errors=[],e.prev=25,e.t0=a.advancedValid,!e.t0){e.next=31;break}return e.next=30,a.$fhirutils.checkConstraints(l.constraints,a.constraints,l.value,l.errors);case 30:e.t0=e.sent;case 31:a.advancedValid=e.t0,e.next=39;break;case 34:e.prev=34,e.t1=e["catch"](25),a.advancedValid=!1,l.errors.push("An unknown error occurred."),console.log(e.t1);case 39:if(!l.$children){e.next=49;break}return e.prev=40,e.next=43,t(d,l.$children,u);case 43:e.next=49;break;case 45:e.prev=45,e.t2=e["catch"](40),a.advancedValid=!1,console.log(e.t2);case 49:if(!l.isQuestionnaireGroup||!l.constraints){e.next=65;break}if(l.errors=[],e.prev=51,e.t3=a.advancedValid,!e.t3){e.next=57;break}return e.next=56,a.$fhirutils.checkConstraints(l.constraints,a.constraints,d,l.errors);case 56:e.t3=e.sent;case 57:a.advancedValid=e.t3,e.next=65;break;case 60:e.prev=60,e.t4=e["catch"](51),a.advancedValid=!1,l.errors.push("An unknown error occurred."),console.log(e.t4);case 65:e.next=4;break;case 67:e.next=72;break;case 69:e.prev=69,e.t5=e["catch"](2),c.e(e.t5);case 72:return e.prev=72,c.f(),e.finish(72);case 75:case"end":return e.stop()}}),e,null,[[2,69,72,75],[25,34],[40,45],[51,60]])})));return function(t,a,r){return e.apply(this,arguments)}}(),this.fhir={resourceType:"QuestionnaireResponse",questionnaire:this.url,status:"completed",item:[]},e.prev=8,e.next=11,t(this.fhir.item,this.$children);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](8),this.advancedValid=!1,console.log(e.t0);case 17:if(this.advancedValid){e.next=22;break}return this.overlay=!1,this.loading=!1,this.$store.commit("setMessage",{type:"error",text:"There were errors on the form."}),e.abrupt("return");case 22:console.log("SAVE",this.fhir),fetch("/fhir/QuestionnaireResponse?"+c.stringify(this.$route.query),{method:"POST",headers:{"Content-Type":"application/fhir+json"},redirect:"manual",body:JSON.stringify(this.fhir)}).then((function(e){201===e.status&&(e.json().then((function(e){var t;if(a.overlay=!1,a.loading=!1,a.viewPage){if(e.meta.tag){var r=e.meta.tag.find((function(e){return"http://ihris.org/fhir/tags/resource"===e.system}));r&&r.code&&(t=r.code)}if(!t&&e.subject&&e.subject.reference&&(t=e.subject.reference),t){var s=t.split("/");s=s[1]?s[1]:t,a.$router.push({name:"resource_view",params:{page:a.viewPage,id:s}})}}t||a.$router.push({name:"home"})})),a.$store.commit("setMessage",{type:"success",text:"Update successful."}))})).catch((function(e){console.log(e),a.overlay=!1,a.loading=!1,a.$store.commit("setMessage",{type:"error",text:"Failed to update data."})}));case 24:case"end":return e.stop()}}),e,this,[[8,13]])})));function t(){return e.apply(this,arguments)}return t}()}},l=o,d=a("2877"),u=a("6544"),v=a.n(u),h=a("8336"),p=a("a523"),f=a("ce7e"),m=a("4bd4"),b=a("132d"),x=a("8860"),k=a("da13"),g=a("5d23"),w=a("f774"),V=a("a797"),y=a("490a"),_=a("2fa4"),C=a("e0c7"),$=Object(d["a"])(l,r,s,!1,null,null,null);t["default"]=$.exports;v()($,{VBtn:h["a"],VContainer:p["a"],VDivider:f["a"],VForm:m["a"],VIcon:b["a"],VList:x["a"],VListItem:k["a"],VListItemContent:g["a"],VListItemSubtitle:g["b"],VListItemTitle:g["c"],VNavigationDrawer:w["a"],VOverlay:V["a"],VProgressCircular:y["a"],VSpacer:_["a"],VSubheader:C["a"]})}}]);
//# sourceMappingURL=fhir-questionnaire.8e05f1b3.js.map